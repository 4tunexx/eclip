#!/usr/bin/env node
/**
 * Seed 55 Missions (5 Daily + 50 Main)
 * Based on WORK/02_MISSIONS_FULL.md
 */

import postgres from 'postgres';
import dotenv from 'dotenv';
import crypto from 'crypto';

dotenv.config();

const sql = postgres(process.env.DATABASE_URL, { max: 1 });

const missions = [
  // DAILY MISSIONS (5)
  {
    id: crypto.randomUUID(),
    title: 'Warm-Up Win',
    description: 'Win 1 ranked match today.',
    category: 'DAILY',
    isDaily: true,
    metricName: 'wins_today',
    objectiveValue: 1,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Getting Started',
    description: 'Play 2 ranked matches today.',
    category: 'DAILY',
    isDaily: true,
    metricName: 'matches_today',
    objectiveValue: 2,
    rewardXp: 200,
    rewardCoins: 8,
  },
  {
    id: crypto.randomUUID(),
    title: 'Team Player',
    description: 'Get 10 assists today.',
    category: 'DAILY',
    isDaily: true,
    metricName: 'assists_today',
    objectiveValue: 10,
    rewardXp: 220,
    rewardCoins: 8,
  },
  {
    id: crypto.randomUUID(),
    title: 'Headshot Check',
    description: 'Get 15 headshot kills today.',
    category: 'DAILY',
    isDaily: true,
    metricName: 'hs_kills_today',
    objectiveValue: 15,
    rewardXp: 260,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Eclip Habit',
    description: 'Log in and visit your dashboard.',
    category: 'DAILY',
    isDaily: true,
    metricName: 'dashboard_visit_today',
    objectiveValue: 1,
    rewardXp: 150,
    rewardCoins: 5,
  },

  // PLATFORM MISSIONS (20)
  {
    id: crypto.randomUUID(),
    title: 'Complete Your Profile',
    description: 'Fill out your bio and social links.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'profile_completed',
    objectiveValue: 1,
    rewardXp: 300,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Upload an Avatar',
    description: 'Upload a custom profile picture.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'avatar_uploaded',
    objectiveValue: 1,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'First Friend',
    description: 'Add 1 friend on Eclip.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'friends_added',
    objectiveValue: 1,
    rewardXp: 200,
    rewardCoins: 8,
  },
  {
    id: crypto.randomUUID(),
    title: 'Squad Builder',
    description: 'Add 5 friends on Eclip.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'friends_added',
    objectiveValue: 5,
    rewardXp: 300,
    rewardCoins: 12,
  },
  {
    id: crypto.randomUUID(),
    title: 'Forum Newcomer',
    description: 'Create your first forum post.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'forum_posts',
    objectiveValue: 1,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Forum Regular',
    description: 'Create 10 forum posts.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'forum_posts',
    objectiveValue: 10,
    rewardXp: 400,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Helpful Voice',
    description: 'Receive 5 upvotes on your forum posts.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'forum_upvotes',
    objectiveValue: 5,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Customization Starter',
    description: 'Equip a banner on your profile.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'banner_equipped',
    objectiveValue: 1,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Style Upgrade',
    description: 'Equip an avatar frame.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'frame_equipped',
    objectiveValue: 1,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Show-Off',
    description: 'Equip at least 2 cosmetic items at once.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'cosmetics_equipped_set',
    objectiveValue: 1,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Daily Grinder',
    description: 'Complete 5 daily missions in total.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'dailies_completed_total',
    objectiveValue: 5,
    rewardXp: 400,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Weekly Warrior',
    description: 'Complete 15 daily missions in total.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'dailies_completed_total',
    objectiveValue: 15,
    rewardXp: 600,
    rewardCoins: 25,
  },
  {
    id: crypto.randomUUID(),
    title: 'Social Starter',
    description: 'Send 5 direct messages.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'dm_sent',
    objectiveValue: 5,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Social Pro',
    description: 'Send 25 direct messages.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'dm_sent',
    objectiveValue: 25,
    rewardXp: 400,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Login Streak I',
    description: 'Log in 3 days in a row.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'login_streak',
    objectiveValue: 3,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Login Streak II',
    description: 'Log in 7 days in a row.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'login_streak',
    objectiveValue: 7,
    rewardXp: 600,
    rewardCoins: 25,
  },
  {
    id: crypto.randomUUID(),
    title: 'Level 5 Reached',
    description: 'Reach account level 5.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'level_reached',
    objectiveValue: 5,
    rewardXp: 500,
    rewardCoins: 20,
  },
  {
    id: crypto.randomUUID(),
    title: 'Level 10 Reached',
    description: 'Reach account level 10.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'level_reached',
    objectiveValue: 10,
    rewardXp: 800,
    rewardCoins: 35,
  },
  {
    id: crypto.randomUUID(),
    title: 'Match Ready',
    description: 'Verify your email and link Steam.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'fully_verified',
    objectiveValue: 1,
    rewardXp: 400,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Community Member',
    description: 'Join 3 different forum threads.',
    category: 'PLATFORM',
    isDaily: false,
    metricName: 'different_threads_participated',
    objectiveValue: 3,
    rewardXp: 300,
    rewardCoins: 12,
  },

  // INGAME MISSIONS (30)
  {
    id: crypto.randomUUID(),
    title: 'First Blood',
    description: 'Get the first kill in a match.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'first_bloods',
    objectiveValue: 1,
    rewardXp: 250,
    rewardCoins: 10,
  },
  {
    id: crypto.randomUUID(),
    title: 'Sharpshooter I',
    description: 'Get 50 kills in total.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'kills_total',
    objectiveValue: 50,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Sharpshooter II',
    description: 'Get 250 kills in total.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'kills_total',
    objectiveValue: 250,
    rewardXp: 700,
    rewardCoins: 30,
  },
  {
    id: crypto.randomUUID(),
    title: 'Headshot Starter',
    description: 'Get 25 headshot kills.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'hs_kills',
    objectiveValue: 25,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Headshot Machine',
    description: 'Get 150 headshot kills.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'hs_kills',
    objectiveValue: 150,
    rewardXp: 800,
    rewardCoins: 35,
  },
  {
    id: crypto.randomUUID(),
    title: 'Clutch Moment',
    description: 'Win 1 clutch (1v2 or worse).',
    category: 'INGAME',
    isDaily: false,
    metricName: 'clutches_won',
    objectiveValue: 1,
    rewardXp: 300,
    rewardCoins: 12,
  },
  {
    id: crypto.randomUUID(),
    title: 'Clutch King',
    description: 'Win 10 clutches.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'clutches_won',
    objectiveValue: 10,
    rewardXp: 900,
    rewardCoins: 40,
  },
  {
    id: crypto.randomUUID(),
    title: 'Bomb Plant I',
    description: 'Plant the bomb 10 times.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'bomb_plants',
    objectiveValue: 10,
    rewardXp: 300,
    rewardCoins: 12,
  },
  {
    id: crypto.randomUUID(),
    title: 'Bomb Defuse I',
    description: 'Defuse the bomb 5 times.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'bomb_defuses',
    objectiveValue: 5,
    rewardXp: 300,
    rewardCoins: 12,
  },
  {
    id: crypto.randomUUID(),
    title: 'Entry Fragger',
    description: 'Get 25 entry kills.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'entry_kills',
    objectiveValue: 25,
    rewardXp: 450,
    rewardCoins: 18,
  },
  {
    id: crypto.randomUUID(),
    title: 'Support Master',
    description: 'Get 50 assists.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'assists_total',
    objectiveValue: 50,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Damage Dealer',
    description: 'Deal 10,000 total damage.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'damage_total',
    objectiveValue: 10000,
    rewardXp: 500,
    rewardCoins: 20,
  },
  {
    id: crypto.randomUUID(),
    title: 'Pistol Round Pro',
    description: 'Win 10 pistol rounds.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'pistol_round_wins',
    objectiveValue: 10,
    rewardXp: 350,
    rewardCoins: 15,
  },
  {
    id: crypto.randomUUID(),
    title: 'Comeback Kid',
    description: 'Win a match after being down 5 rounds.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'comeback_wins',
    objectiveValue: 1,
    rewardXp: 600,
    rewardCoins: 25,
  },
  {
    id: crypto.randomUUID(),
    title: 'Eco Hero',
    description: 'Win 5 rounds with low-cost weapons.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'eco_rounds_won',
    objectiveValue: 5,
    rewardXp: 400,
    rewardCoins: 18,
  },
  {
    id: crypto.randomUUID(),
    title: 'Ace Hunter',
    description: 'Get 1 ace (5k) in any match.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'aces_done',
    objectiveValue: 1,
    rewardXp: 700,
    rewardCoins: 30,
  },
  {
    id: crypto.randomUUID(),
    title: 'Multi-Kill Master',
    description: 'Get 25 multi-kill rounds (2k or more).',
    category: 'INGAME',
    isDaily: false,
    metricName: 'multi_kill_rounds',
    objectiveValue: 25,
    rewardXp: 500,
    rewardCoins: 20,
  },
  {
    id: crypto.randomUUID(),
    title: 'Flawless Win',
    description: 'Win a match without losing a round.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'flawless_match_wins',
    objectiveValue: 1,
    rewardXp: 800,
    rewardCoins: 35,
  },
  {
    id: crypto.randomUUID(),
    title: 'Perfect Round',
    description: 'Get 16 kills without dying in a round.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'perfect_rounds',
    objectiveValue: 1,
    rewardXp: 600,
    rewardCoins: 25,
  },
  {
    id: crypto.randomUUID(),
    title: 'MVP I',
    description: 'Be MVP in 5 matches.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'mvp_matches',
    objectiveValue: 5,
    rewardXp: 450,
    rewardCoins: 18,
  },
  {
    id: crypto.randomUUID(),
    title: 'Spree Killer',
    description: 'Get 20 killing spree rounds (4+ kills).',
    category: 'INGAME',
    isDaily: false,
    metricName: 'spree_kill_rounds',
    objectiveValue: 20,
    rewardXp: 500,
    rewardCoins: 20,
  },
  {
    id: crypto.randomUUID(),
    title: 'Pistol Round Master',
    description: 'Win 25 pistol rounds.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'pistol_round_wins',
    objectiveValue: 25,
    rewardXp: 600,
    rewardCoins: 25,
  },
  {
    id: crypto.randomUUID(),
    title: 'Double Ace',
    description: 'Get 2 aces in any matches.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'aces_done',
    objectiveValue: 2,
    rewardXp: 900,
    rewardCoins: 40,
  },
  {
    id: crypto.randomUUID(),
    title: 'Consistent Killer',
    description: 'Get 1000 kills.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'kills_total',
    objectiveValue: 1000,
    rewardXp: 1200,
    rewardCoins: 50,
  },
  {
    id: crypto.randomUUID(),
    title: 'Headshot Expert',
    description: 'Get 500 headshot kills.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'hs_kills',
    objectiveValue: 500,
    rewardXp: 1000,
    rewardCoins: 45,
  },
  {
    id: crypto.randomUUID(),
    title: 'Damage Master',
    description: 'Deal 50,000 total damage.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'damage_total',
    objectiveValue: 50000,
    rewardXp: 1100,
    rewardCoins: 48,
  },
  {
    id: crypto.randomUUID(),
    title: 'Team Player II',
    description: 'Get 200 assists.',
    category: 'INGAME',
    isDaily: false,
    metricName: 'assists_total',
    objectiveValue: 200,
    rewardXp: 800,
    rewardCoins: 35,
  },
];

async function main() {
  try {
    console.log('üöÄ Seeding 55 missions...\n');

    let inserted = 0;
    for (const mission of missions) {
      await sql.unsafe(`
        INSERT INTO "Mission" (id, title, description, category, "isDaily", "metricName", "objectiveType", "objectiveValue", "rewardXp", "rewardCoins", type)
        VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, 'DAILY')
        ON CONFLICT DO NOTHING;
      `, [
        mission.id,
        mission.title,
        mission.description,
        mission.category,
        mission.isDaily,
        mission.metricName,
        mission.metricName,
        mission.objectiveValue,
        mission.rewardXp,
        mission.rewardCoins,
      ]);
      inserted++;

      if (inserted % 10 === 0) {
        console.log(`  ‚úì Inserted ${inserted} missions...`);
      }
    }

    console.log(`\n‚úÖ Successfully seeded ${inserted} missions!\n`);
    console.log('Breakdown:');
    console.log('  ‚úì 5 Daily missions');
    console.log('  ‚úì 20 Platform missions');
    console.log('  ‚úì 30 In-Game missions');

    await sql.end();
    process.exit(0);
  } catch (error) {
    console.error('‚ùå Seeding failed:', error.message);
    process.exit(1);
  }
}

main();
